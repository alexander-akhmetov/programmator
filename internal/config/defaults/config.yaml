# Programmator Configuration
# This file defines the default configuration for programmator.
# Override at:
#   - Global: ~/.config/programmator/config.yaml
#   - Local:  .programmator/config.yaml (project-specific)

# Loop settings
max_iterations: 50 # Maximum loop iterations before forced exit
stagnation_limit: 3 # Exit after N consecutive iterations with no file changes
timeout: 900 # Seconds per executor invocation

# Executor settings
executor: claude # Which coding agent to use ("claude", "pi", "opencode", or "codex")

# Claude executor settings
claude:
  flags: "" # Additional flags passed to claude command
  config_dir: "" # Custom Claude config directory (empty = default)
  anthropic_api_key: "" # Anthropic API key to pass to Claude (filters inherited ANTHROPIC_API_KEY)

# Pi coding agent settings
pi:
  flags: "" # Additional flags passed to pi command
  config_dir: "" # Custom PI_CODING_AGENT_DIR (empty = default)
  provider: "" # LLM provider (e.g. "anthropic", "openai")
  model: "" # Model name (e.g. "sonnet", "gpt-4o")
  api_key: "" # API key for the configured provider

# OpenCode executor settings
opencode:
  flags: "" # Additional flags passed to opencode command
  config_dir: "" # Custom OPENCODE_CONFIG_DIR (empty = default)
  model: "" # Model in "provider/model" format (e.g. "anthropic/claude-sonnet-4-5")
  api_key: "" # API key for the configured provider

# Codex executor settings
# Note: --dangerously-bypass-approvals-and-sandbox is auto-injected at runtime.
codex:
  flags: "" # Additional flags passed to codex command
  model: "" # Model name (e.g. "o3", "gpt-5-codex")
  api_key: "" # OpenAI API key

# Ticket settings
ticket_command: "tk" # Binary name for the ticket CLI (tk or ticket)

# Git workflow settings
git:
  auto_commit: false # Auto-commit after each phase completion
  move_completed_plans: false # Move completed plans to completed/ directory
  completed_plans_dir: "" # Directory for completed plans (default: plans/completed)
  branch_prefix: "" # Prefix for auto-created branches (default: programmator/)

# Review settings
review:
  max_iterations: 3 # Maximum review fix iterations
  parallel: true # Run agents in parallel

  # Optional review-specific executor override.
  # If name is empty, review uses top-level executor/claude/pi settings.
  executor:
    name: "" # "claude", "pi", "opencode", or "codex"
    claude:
      flags: "" # Example: "--model opus"
      config_dir: ""
      anthropic_api_key: ""
    pi:
      flags: ""
      config_dir: ""
      provider: ""
      model: ""
      api_key: ""
    opencode:
      flags: ""
      config_dir: ""
      model: ""
      api_key: ""
    codex:
      flags: ""
      model: ""
      api_key: ""

  # Agent selection strategy (auto-detected):
  # - If review.agents is non-empty, use exactly that list (custom mode).
  # - Otherwise, start from built-in default agents and apply include/exclude/overrides.
  include: [] # Subset of default agent names; empty = all defaults
  exclude: [] # Remove specific default agents by name
  overrides: [] # Per-default-agent overrides (name + optional focus/prompt/prompt_file)
  agents: [] # Explicit custom agents (replaces defaults when non-empty)

  # Optional validator passes after primary review agents.
  validators:
    issue: true # Run false-positive validator for non-simplification findings
    simplification: true # Run value validator for simplification findings
